[2025-07-23T13:46:14.219+0000] {local_task_job_runner.py:123} INFO - ::group::Pre task execution logs
[2025-07-23T13:46:14.237+0000] {taskinstance.py:2631} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: startup_health_score_full_pipeline.calculate_startup_health_scores streamlit_trigger_sample.txt_20250723134558 [queued]>
[2025-07-23T13:46:14.248+0000] {taskinstance.py:2631} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: startup_health_score_full_pipeline.calculate_startup_health_scores streamlit_trigger_sample.txt_20250723134558 [queued]>
[2025-07-23T13:46:14.248+0000] {taskinstance.py:2884} INFO - Starting attempt 1 of 2
[2025-07-23T13:46:14.259+0000] {taskinstance.py:2907} INFO - Executing <Task(PythonOperator): calculate_startup_health_scores> on 2025-07-23 13:45:58.837655+00:00
[2025-07-23T13:46:14.267+0000] {warnings.py:112} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:70: DeprecationWarning: This process (pid=116) is multi-threaded, use of fork() may lead to deadlocks in the child.
  pid = os.fork()

[2025-07-23T13:46:14.268+0000] {standard_task_runner.py:72} INFO - Started process 118 to run task
[2025-07-23T13:46:14.269+0000] {standard_task_runner.py:104} INFO - Running: ['***', 'tasks', 'run', 'startup_health_score_full_pipeline', 'calculate_startup_health_scores', 'streamlit_trigger_sample.txt_20250723134558', '--job-id', '17', '--raw', '--subdir', 'DAGS_FOLDER/startup_health_score_dag.py', '--cfg-path', '/tmp/tmpryelch3b']
[2025-07-23T13:46:14.271+0000] {standard_task_runner.py:105} INFO - Job 17: Subtask calculate_startup_health_scores
[2025-07-23T13:46:14.316+0000] {task_command.py:467} INFO - Running <TaskInstance: startup_health_score_full_pipeline.calculate_startup_health_scores streamlit_trigger_sample.txt_20250723134558 [running]> on host f228824c2da2
[2025-07-23T13:46:14.389+0000] {taskinstance.py:3157} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='startup_health_score_full_pipeline' AIRFLOW_CTX_TASK_ID='calculate_startup_health_scores' AIRFLOW_CTX_EXECUTION_DATE='2025-07-23T13:45:58.837655+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='streamlit_trigger_sample.txt_20250723134558'
[2025-07-23T13:46:14.390+0000] {taskinstance.py:740} INFO - ::endgroup::
[2025-07-23T13:46:14.402+0000] {log.py:232} WARNING - 2025-07-23 13:46:14,402 - startup_health_score - INFO - Calculating startup health scores...
[2025-07-23T13:46:14.402+0000] {startup_health_score_dag.py:155} INFO - Calculating startup health scores...
[2025-07-23T13:46:14.415+0000] {log.py:232} WARNING - 2025-07-23 13:46:14,415 - startup_health_score - INFO - Successfully loaded configuration from /opt/***/config/kpi_benchmarks.json
[2025-07-23T13:46:14.415+0000] {config_loader.py:43} INFO - Successfully loaded configuration from /opt/***/config/kpi_benchmarks.json
[2025-07-23T13:46:14.417+0000] {log.py:232} WARNING - 2025-07-23 13:46:14,417 - startup_health_score - INFO - Successfully loaded configuration from /opt/***/config/kpi_weights.json
[2025-07-23T13:46:14.417+0000] {config_loader.py:43} INFO - Successfully loaded configuration from /opt/***/config/kpi_weights.json
[2025-07-23T13:46:14.418+0000] {log.py:232} WARNING - 2025-07-23 13:46:14,418 - startup_health_score - INFO - KPINormalizer initialized with KPI formula aliases.
[2025-07-23T13:46:14.418+0000] {kpi_normalizer.py:21} INFO - KPINormalizer initialized with KPI formula aliases.
[2025-07-23T13:46:14.419+0000] {log.py:232} WARNING - 2025-07-23 13:46:14,419 - startup_health_score - INFO - Identified mandatory KPIs: ['Monthly Recurring Revenue (MRR)', 'Burn Rate', 'Runway (in Months)', 'Gross Margin (%)', 'MRR Growth Rate', 'Customer Acquisition Cost (CAC)', 'Net Revenue Retention (NRR)', 'Customer (Logo) Churn Rate', 'Founder Commitment (Full-Time)', 'Onboarding Completion Rate']
[2025-07-23T13:46:14.419+0000] {scoring_engine.py:56} INFO - Identified mandatory KPIs: ['Monthly Recurring Revenue (MRR)', 'Burn Rate', 'Runway (in Months)', 'Gross Margin (%)', 'MRR Growth Rate', 'Customer Acquisition Cost (CAC)', 'Net Revenue Retention (NRR)', 'Customer (Logo) Churn Rate', 'Founder Commitment (Full-Time)', 'Onboarding Completion Rate']
[2025-07-23T13:46:14.419+0000] {log.py:232} WARNING - 2025-07-23 13:46:14,419 - startup_health_score - INFO - Collected all expected KPI names: ['Monthly Recurring Revenue (MRR)', 'Annual Recurring Revenue (ARR)', 'Burn Rate', 'Runway (in Months)', 'Gross Margin (%)', 'Operating Margin (or EBITDA)', 'MRR Growth Rate', 'User Growth Rate', 'Lead-to-Customer Conversion Rate', 'Trial-to-Paid Conversion Rate', 'Signup-to-MRR Ratio', 'Expansion Revenue', 'Customer Acquisition Cost (CAC)', 'Customer Lifetime Value (CLV or LTV)', 'CAC-to-CLV Ratio', 'CAC Payback Period', 'Contribution Margin', 'Net Revenue Retention (NRR)', 'Customer (Logo) Churn Rate', 'Revenue Churn Rate', 'Daily Active Users / Monthly Active Users (DAU/MAU)', 'Day-30 Retention Rate', 'Day-90 Retention Rate', 'Founder Commitment (Full-Time)', 'Arr per Fte', 'Team Size', 'KPI Update Frequency', 'Time Since Last Fundraise', 'Net Promoter Score (NPS)', 'Customer Satisfaction Score (CSAT)', 'Onboarding Completion Rate', 'Average Time to Resolution (Support)', 'Support Ticket Volume']
[2025-07-23T13:46:14.419+0000] {scoring_engine.py:64} INFO - Collected all expected KPI names: ['Monthly Recurring Revenue (MRR)', 'Annual Recurring Revenue (ARR)', 'Burn Rate', 'Runway (in Months)', 'Gross Margin (%)', 'Operating Margin (or EBITDA)', 'MRR Growth Rate', 'User Growth Rate', 'Lead-to-Customer Conversion Rate', 'Trial-to-Paid Conversion Rate', 'Signup-to-MRR Ratio', 'Expansion Revenue', 'Customer Acquisition Cost (CAC)', 'Customer Lifetime Value (CLV or LTV)', 'CAC-to-CLV Ratio', 'CAC Payback Period', 'Contribution Margin', 'Net Revenue Retention (NRR)', 'Customer (Logo) Churn Rate', 'Revenue Churn Rate', 'Daily Active Users / Monthly Active Users (DAU/MAU)', 'Day-30 Retention Rate', 'Day-90 Retention Rate', 'Founder Commitment (Full-Time)', 'Arr per Fte', 'Team Size', 'KPI Update Frequency', 'Time Since Last Fundraise', 'Net Promoter Score (NPS)', 'Customer Satisfaction Score (CSAT)', 'Onboarding Completion Rate', 'Average Time to Resolution (Support)', 'Support Ticket Volume']
[2025-07-23T13:46:14.420+0000] {log.py:232} WARNING - 2025-07-23 13:46:14,419 - startup_health_score - INFO - ScoringEngine initialized successfully.
[2025-07-23T13:46:14.419+0000] {scoring_engine.py:31} INFO - ScoringEngine initialized successfully.
[2025-07-23T13:46:14.422+0000] {log.py:232} WARNING - 2025-07-23 13:46:14,420 - startup_health_score - ERROR - ZeroDivisionError in formula '500000 / (value + 500000) * 100' for KPI 'Burn Rate' with value '-500000.0' and params '{'reference_Burn': 500000}'.
Traceback (most recent call last):
  File "/opt/***/src/core/kpi_normalizer.py", line 86, in _evaluate_formula
    result = eval(formula_str, {"__builtins__": None}, eval_context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 1, in <module>
ZeroDivisionError: float division by zero
[2025-07-23T13:46:14.420+0000] {kpi_normalizer.py:89} ERROR - ZeroDivisionError in formula '500000 / (value + 500000) * 100' for KPI 'Burn Rate' with value '-500000.0' and params '{'reference_Burn': 500000}'.
Traceback (most recent call last):
  File "/opt/airflow/src/core/kpi_normalizer.py", line 86, in _evaluate_formula
    result = eval(formula_str, {"__builtins__": None}, eval_context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 1, in <module>
ZeroDivisionError: float division by zero
[2025-07-23T13:46:14.423+0000] {log.py:232} WARNING - 2025-07-23 13:46:14,422 - startup_health_score - ERROR - Failed to normalize KPI 'Burn Rate' with value '-500000': float division by zero
Traceback (most recent call last):
  File "/opt/***/src/core/kpi_normalizer.py", line 158, in normalize_kpi
    normalized_score = self._evaluate_formula(
                       ^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/***/src/core/kpi_normalizer.py", line 86, in _evaluate_formula
    result = eval(formula_str, {"__builtins__": None}, eval_context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 1, in <module>
ZeroDivisionError: float division by zero
[2025-07-23T13:46:14.422+0000] {kpi_normalizer.py:169} ERROR - Failed to normalize KPI 'Burn Rate' with value '-500000': float division by zero
Traceback (most recent call last):
  File "/opt/airflow/src/core/kpi_normalizer.py", line 158, in normalize_kpi
    normalized_score = self._evaluate_formula(
                       ^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/airflow/src/core/kpi_normalizer.py", line 86, in _evaluate_formula
    result = eval(formula_str, {"__builtins__": None}, eval_context)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 1, in <module>
ZeroDivisionError: float division by zero
[2025-07-23T13:46:14.424+0000] {log.py:232} WARNING - 2025-07-23 13:46:14,424 - startup_health_score - WARNING - KPI 'Runway (in Months)' has unparseable numeric string value 'Infinite'. Returning 0.0.
[2025-07-23T13:46:14.424+0000] {kpi_normalizer.py:147} WARNING - KPI 'Runway (in Months)' has unparseable numeric string value 'Infinite'. Returning 0.0.
[2025-07-23T13:46:14.425+0000] {log.py:232} WARNING - 2025-07-23 13:46:14,425 - startup_health_score - WARNING - KPI 'CAC-to-CLV Ratio' has unparseable numeric string value '1:40'. Returning 0.0.
[2025-07-23T13:46:14.425+0000] {kpi_normalizer.py:147} WARNING - KPI 'CAC-to-CLV Ratio' has unparseable numeric string value '1:40'. Returning 0.0.
[2025-07-23T13:46:14.426+0000] {log.py:232} WARNING - 2025-07-23 13:46:14,426 - startup_health_score - INFO - Calculated total score: 65.30
[2025-07-23T13:46:14.426+0000] {scoring_engine.py:180} INFO - Calculated total score: 65.30
[2025-07-23T13:46:14.434+0000] {log.py:232} WARNING - 2025-07-23 13:46:14,434 - startup_health_score - INFO - Scoring results saved to /opt/***/processed_data/sample_txt_startup_score_output.json
[2025-07-23T13:46:14.434+0000] {startup_health_score_dag.py:192} INFO - Scoring results saved to /opt/***/processed_data/sample_txt_startup_score_output.json
[2025-07-23T13:46:14.435+0000] {log.py:232} WARNING - 2025-07-23 13:46:14,435 - startup_health_score - INFO - Total Score: 65.3
[2025-07-23T13:46:14.435+0000] {startup_health_score_dag.py:198} INFO - Total Score: 65.3
[2025-07-23T13:46:14.435+0000] {python.py:240} INFO - Done. Returned value was: None
[2025-07-23T13:46:14.443+0000] {taskinstance.py:349} INFO - ::group::Post task execution logs
[2025-07-23T13:46:14.443+0000] {taskinstance.py:361} INFO - Marking task as SUCCESS. dag_id=startup_health_score_full_pipeline, task_id=calculate_startup_health_scores, run_id=streamlit_trigger_sample.txt_20250723134558, execution_date=20250723T134558, start_date=20250723T134614, end_date=20250723T134614
[2025-07-23T13:46:14.493+0000] {local_task_job_runner.py:266} INFO - Task exited with return code 0
[2025-07-23T13:46:14.504+0000] {taskinstance.py:3924} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2025-07-23T13:46:14.505+0000] {local_task_job_runner.py:245} INFO - ::endgroup::
